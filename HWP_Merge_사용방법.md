# HWP 파일 통합 매크로 사용 방법

## 1. 설치 방법

### 1.1 VBA 모듈 가져오기
1. Excel에서 `Alt + F11` → VBA 편집기 열기
2. 메뉴 → `파일(File)` → `파일 가져오기(Import File)`
3. `HWP_Merge_Module.bas` 파일 선택
4. VBA 편집기 닫기

### 1.2 참조 설정 (필수)
1. VBA 편집기에서 `도구(Tools)` → `참조(References)`
2. `Microsoft Scripting Runtime` 체크
3. 확인 클릭

### 1.3 버튼 생성
1. Excel 시트에서 `개발 도구` 탭 → `삽입` → `버튼(양식 컨트롤)`
2. 버튼 3개 생성:
   - **버튼1**: "1. 목록 가져오기" → `GetFileList` 연결
   - **버튼2**: "2. 통합 실행" → `MergeFiles` 연결
   - **버튼3**: "3. 목록 초기화" → `ClearList` 연결

> **참고**: 개발 도구 탭이 없으면 `파일 → 옵션 → 리본 사용자 지정`에서 활성화

---

## 2. 사용 방법

### Step 1: 목록 가져오기
1. **[1. 목록 가져오기]** 버튼 클릭
2. 폴더 선택 다이얼로그에서 HWP 파일이 있는 폴더 선택
3. "제어판" 시트에 파일 목록이 자동 생성됨

### Step 2: 순번 입력
1. B열 "통합순번"에 원하는 순서대로 숫자 입력
   - 예: 1, 2, 3, 4...
   - 순번을 입력하지 않은 파일은 통합에서 제외됨
   - 중간 번호 생략 가능 (1, 3, 5도 정상 동작)

### Step 3: 통합 실행
1. **[2. 통합 실행]** 버튼 클릭
2. 한글 프로그램이 열리면서 파일 통합 진행
3. 완료 시 결과 메시지 표시
4. 통합된 파일은 원본 폴더에 "통합파일.hwp"로 저장

---

## 3. 시트 구조

| 열 | 내용 | 설명 |
|---|------|------|
| A | 파일명 | HWP 파일 이름 |
| B | 통합순번 | 사용자가 입력 (1, 2, 3...) |
| C | 상태 | 처리 결과 표시 |
| D | 비고 | 에러 메시지 등 |
| E | 전체경로 | 파일 전체 경로 |

### 상태 표시
| 상태 | 의미 |
|------|------|
| ✓ 완료 | 통합 성공 |
| ✗ 실패 | 통합 실패 (비고 확인) |
| - 제외 | 순번 미입력으로 제외 |
| ⏳ 처리중 | 현재 처리 중 |

---

## 4. 주의사항

### 필수 조건
- **한컴오피스 한글 2010 이상** 설치 필요
- Windows 환경에서만 동작

### 파일명 규칙
- 통합 파일은 "통합파일.hwp"로 저장
- 이미 존재하면 "통합파일2.hwp", "통합파일3.hwp"... 자동 생성

### 순번 입력
- 숫자만 입력 가능 (문자 입력 시 제외 처리)
- 중복 순번은 허용되지 않음 (실행 전 검증)
- 음수도 유효한 순번으로 인식

### 서식 유지
- 각 파일의 원본 서식이 그대로 유지됨 (구역 나누기 적용)
- 용지 설정, 여백, 글꼴 등 모두 보존

---

## 5. 문제 해결

### "한글 프로그램을 찾을 수 없습니다"
→ 한컴오피스가 설치되어 있는지 확인

### "순번 N이 중복됩니다"
→ B열에서 중복된 순번 수정

### 특정 파일만 "✗ 실패"
→ 해당 파일이 손상되었거나, 다른 프로그램에서 열려 있을 수 있음

### 매크로가 실행되지 않음
→ Excel 보안 설정에서 매크로 허용 필요
   `파일 → 옵션 → 보안 센터 → 보안 센터 설정 → 매크로 설정`

---

## 6. 파일 목록

| 파일명 | 설명 |
|--------|------|
| `HWP_Merge_Module.bas` | VBA 모듈 코드 |
| `HWP_Merge_Dev_Guide.md` | 개발 가이드라인 |
| `HWP_Merge_사용방법.md` | 이 문서 (사용 방법) |
