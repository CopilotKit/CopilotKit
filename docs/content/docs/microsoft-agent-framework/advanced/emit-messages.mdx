---
title: "Manually emitting messages"
icon: "lucide/Radio"
description: "Understanding how messages stream in Microsoft Agent Framework with AG-UI"
---

<video src="https://cdn.copilotkit.ai/docs/copilotkit/images/microsoft-agent-framework/emit-messages.mp4" className="rounded-lg shadow-xl" loop playsInline controls autoPlay muted />

## What is this?

Microsoft Agent Framework automatically streams messages to the frontend via the AG-UI protocol using Server-Sent Events (SSE). As your agent generates responses, they're streamed in real-time without requiring special emission code.

## When should I use this?

Message streaming is **automatic** in MAF with AG-UI. You don't need to manually emit messages - they stream as your agent generates them. This works for:
- Long-running tasks
- Status updates
- Incremental responses
- Tool call results

## How It Works

Messages are automatically streamed via the AG-UI protocol:

```csharp title="Program.cs"
using Azure.AI.OpenAI;
using Azure.Identity;
using Microsoft.Agents.AI;
using Microsoft.Agents.AI.Hosting.AGUI.AspNetCore;

var builder = WebApplication.CreateBuilder(args);
var app = builder.Build();

string endpoint = builder.Configuration["AZURE_OPENAI_ENDPOINT"]!;
string deployment = builder.Configuration["AZURE_OPENAI_DEPLOYMENT_NAME"]!;

app.MapAGUIAgent("/", (messages, tools, context, forwardedProps) =>
{
    var client = new AzureOpenAIClient(new Uri(endpoint), new DefaultAzureCredential());
    var agent = client.GetChatClient(deployment)
        .CreateAIAgent(
            name: "StreamingAgent",
            instructions: "You are a helpful assistant. Be detailed in your explanations."
        );
    
    return agent;
});

await app.RunAsync();
```

The AG-UI protocol handles streaming automatically:
1. Agent generates a response
2. Chunks are sent via Server-Sent Events (SSE)
3. Frontend receives real-time updates
4. No manual emission code required

## Streaming State Updates

For state updates during long-running operations, return state snapshots from your tools. These are automatically streamed via AG-UI:

```csharp
[Description("Perform a long-running research task.")]
static ResearchStateSnapshot PerformResearch([Description("Research topic")] string topic)
{
    // As you complete steps, you can return updated state
    // These snapshots stream to the frontend automatically
    
    return new ResearchStateSnapshot
    {
        Topic = topic,
        Progress = "Completed initial analysis",
        Results = GetResults(topic)
    };
}
```

See [Generative UI - Agent State](/microsoft-agent-framework/generative-ui/agentic) for more on streaming state updates.

<Callout type="info">
  **Automatic streaming** is a core feature of the AG-UI protocol. You don't need special SDK functions to emit messages - just return data from your agent and tools, and AG-UI handles the rest.
</Callout>
