---
title: "Connect to MCP Servers"
description: "Integrate Model Context Protocol (MCP) servers with your existing React application for enhanced AI capabilities"
icon: "lucide/Network"
---

<Callout type="info" title="Are you new to CopilotKit?">
  check out our [Quickstart Guide](https://docs.copilotkit.ai/quickstart) for
  more details.
</Callout>

## What is Model Context Protocol (MCP)?

Model Context Protocol (MCP) is a standard that allows AI models to discover and use tools from external servers. By integrating MCP support, CopilotKit can connect to these servers and leverage their capabilities, expanding what your AI assistant can do.

<Steps>
<Step>
## Setup MCP with CopilotKit
</Step>
// ...
</Steps

To set up MCP with CopilotKit, add the `mcpEndpoints` property to your `CopilotKit` provider:

<Callout type="info" title="Get a Public API Key">
  Sign up for a free{" "}
  <LinkToCopilotCloud asButton={false}>Copilot Cloud</LinkToCopilotCloud>{" "}
  account to obtain your public API key for accessing MCP servers.
</Callout>

```tsx
"use client";

import { CopilotKit } from "@copilotkit/react-core";
import { CopilotChat } from "@copilotkit/react-ui";

export default function PageLevelComponent() {
  return (
    <CopilotKit
      // ... existing props
      publicApiKey="<replace_with_your_own"
      mcpEndpoints={[
        {
          endpoint: "your_mcp_sse_url", // Get a test server from https://mcp.composio.dev/
        },
      ]}
    >
      <div className="flex h-screen p-4">
        <CopilotChat
          instructions="You are a helpful assistant that can answer questions about the user's account. You have access to MCP servers if defined in the mcpEndpoints array."
          className="flex-grow rounded-lg w-full"
        />
      </div>
    </CopilotKit>
  );
}
```

## Rendering MCP Tool Calls

You can visualize MCP tool calls in your UI by using the `useCopilotAction` hook with a catch-all action handler:

```tsx
"use client";

import {
  useCopilotAction,
  CatchAllActionRenderProps,
} from "@copilotkit/react-core";
import MCPToolCall from "./MCPToolCall";

export function ToolRenderer() {
  useCopilotAction({
    name: "*", // Catch all tool calls
    render: ({ name, status, args, result }: CatchAllActionRenderProps<[]>) => (
      <MCPToolCall status={status} name={name} args={args} result={result} />
    ),
  });
  return null;
}
```

### Sample MCPToolCall Component

<details>
<summary>Click to view the MCPToolCall component implementation</summary>

```tsx
"use client";

import * as React from "react";

interface ToolCallProps {
  status: "complete" | "inProgress" | "executing";
  name?: string;
  args?: any;
  result?: any;
}

export default function MCPToolCall({
  status,
  name = "",
  args,
  result,
}: ToolCallProps) {
  const [isOpen, setIsOpen] = React.useState(false);

  // Format string with proper line breaks and quotes
  const formatContent = (str: string): string => {
    const text = typeof str !== "string" ? JSON.stringify(str, null, 2) : str;
    return text
      .replace(/\\n/g, "\n")
      .replace(/\\t/g, "\t")
      .replace(/\\"/g, '"')
      .replace(/\\\\/g, "\\");
  };

  // Format arguments and results
  const formattedArgs = React.useMemo(() => {
    if (!args) return "";
    return formatContent(
      typeof args === "object" ? JSON.stringify(args, null, 2) : args
    );
  }, [args]);

  const formattedResult = React.useMemo(() => {
    if (!result) return "";

    if (typeof result === "object" && result?.error?.message) {
      const copy = { ...result };
      copy.error = { ...copy.error };
      copy.error.message = formatContent(copy.error.message);
      return formatContent(JSON.stringify(copy, null, 2));
    }

    return formatContent(
      typeof result === "object" ? JSON.stringify(result, null, 2) : result
    );
  }, [result]);

  return (
    <div className="bg-[#1e2738] rounded-lg overflow-hidden w-full">
      <div
        className="p-3 flex items-center cursor-pointer"
        onClick={() => setIsOpen(!isOpen)}
      >
        <div className="min-w-0 flex-grow overflow-hidden">
          <span className="text-white text-sm">{name || "MCP Tool Call"}</span>
        </div>
        <div className="ml-auto">
          <div
            className={`w-2 h-2 rounded-full ${
              status === "complete"
                ? "bg-green-500"
                : status === "inProgress" || status === "executing"
                ? "bg-blue-500 animate-pulse"
                : ""
            }`}
          />
        </div>
      </div>

      {isOpen && (
        <div className="px-4 pb-4 text-gray-300 font-mono text-xs">
          {args && (
            <div className="mb-4">
              <div className="text-gray-400 mb-2">Parameters:</div>
              <pre className="whitespace-pre-wrap max-h-[200px] overflow-auto bg-transparent">
                {formattedArgs}
              </pre>
            </div>
          )}

          {status === "complete" && result && (
            <div>
              <div className="text-gray-400 mb-2">Result:</div>
              <pre className="whitespace-pre-wrap max-h-[200px] overflow-auto bg-transparent">
                {formattedResult}
              </pre>
            </div>
          )}
        </div>
      )}
    </div>
  );
}
```

</details>

## Self Hosting

<details>
<summary>Click here to learn how to set up MCP with self-hosting</summary>
<Callout type="info" title="Self Hosting vs Copilot Cloud">
  The Copilot Runtime is the back-end component of CopilotKit, handling the communication with LLM, message history, state and more. You may choose to self-host the Copilot Runtime, or use <LinkToCopilotCloud asButton={false}> Copilot Cloud (recommended). </LinkToCopilotCloud> Learn more about self-hosting in our [Self Hosting Guide](/guides/self-hosting).
</Callout>

Configure your CopilotKit self-hosted runtime to handle MCP server(s) (this example uses Next.js App Router):

```tsx
import {
  CopilotRuntime,
  OpenAIAdapter,
  copilotRuntimeNextJSAppRouterEndpoint,
} from "@copilotkit/runtime";
import { experimental_createMCPClient } from "ai";

import { NextRequest } from "next/server";

const serviceAdapter = new OpenAIAdapter();

const runtime = new CopilotRuntime({
  createMCPClient: async (config) => {
    return await experimental_createMCPClient({
      transport: {
        type: "sse",
        url: config.endpoint,
        headers: config.apiKey
          ? { Authorization: `Bearer ${config.apiKey}` }
          : undefined,
      },
    });
  },
});

export const POST = async (req: NextRequest) => {
  const { handleRequest } = copilotRuntimeNextJSAppRouterEndpoint({
    runtime,
    serviceAdapter,
    endpoint: "/api/copilotkit",
  });

  return handleRequest(req);
};
```

</details>

## What's Next?

import { Database, Code, Server, Bot } from "lucide-react";

<Cards>
  <Card
    title="Connect Your Data"
    href="/guides/connect-your-data/frontend"
    icon={<Database />}
  >
    Learn how to connect your data sources to enhance your AI assistant's
    capabilities.
  </Card>
  <Card
    title="Frontend Actions"
    href="/coagents/frontend-actions"
    icon={<Code />}
  >
    Implement client-side actions that your AI assistant can perform.
  </Card>
  <Card
    title="Backend Actions"
    href="/guides/backend-actions"
    icon={<Server />}
  >
    Create powerful server-side actions for your AI assistant.
  </Card>
  <Card title="Bring Your Agent" href="/coagents" icon={<Bot />}>
    Learn how to integrate your existing agents with CopilotKit.
  </Card>
</Cards>
